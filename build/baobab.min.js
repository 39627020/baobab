/*
 * Baobab
 *
 * Homepage: https://github.com/Yomguithereal/baobab
 * Version: 2.5.2
 * Author: Yomguithereal (Guillaume Plique)
 * License: MIT
 */
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Baobab=t()}}(function(){return function i(a,s,l){function u(n,t){if(!s[n]){if(!a[n]){var e="function"==typeof require&&require;if(!t&&e)return e(n,!0);if(h)return h(n,!0);var r=new Error("Cannot find module '"+n+"'");throw r.code="MODULE_NOT_FOUND",r}var o=s[n]={exports:{}};a[n][0].call(o.exports,function(t){var e=a[n][1][t];return u(e||t)},o,o.exports,i,a,s,l)}return s[n].exports}for(var h="function"==typeof require&&require,t=0;t<l.length;t++)u(l[t]);return u}({1:[function(t,e,n){(function(){"use strict";var h={once:"boolean",scope:"object"},f=0;function c(t){return t&&"object"==typeof t&&!Array.isArray(t)&&!(t instanceof Function)&&!(t instanceof RegExp)}function p(t,e,n){var r,o,i,a;for(o in t)e.call(n||null,o,t[o]);if(Object.getOwnPropertySymbols)for(i=0,a=(r=Object.getOwnPropertySymbols(t)).length;i<a;i++)e.call(n||null,r[i],t[r[i]])}var t=function(){this._enabled=!0,this.unbindAll()};function s(t,e){var n,r,o=[];for(r=0,n=(t=t||[]).length;r<n;r++)t[r].fn!==e&&o.push(t[r]);return o}t.prototype.unbindAll=function(){return this._handlers={},this._handlersAll=[],this._handlersComplex=[],this},t.prototype.on=function(t,n,e){var r,o,i,a,s,l,u;if(c(t))return p(t,function(t,e){this.on(t,e,n)},this),this;for("function"==typeof t&&(e=n,n=t,t=null),r=0,o=(s=[].concat(t)).length;r<o;r++){if(a=s[r],u={order:f++,fn:n},"string"==typeof a||"symbol"==typeof a)this._handlers[a]||(this._handlers[a]=[]),l=this._handlers[a],u.type=a;else if(a instanceof RegExp)l=this._handlersComplex,u.pattern=a;else{if(null!==a)throw Error("Emitter.on: invalid event.");l=this._handlersAll}for(i in e||{})h[i]&&(u[i]=e[i]);l.push(u)}return this},t.prototype.once=function(){var t=Array.prototype.slice.call(arguments),e=t.length-1;return c(t[e])&&1<t.length?t[e]=function(t,e){var n,r={};for(n in t)r[n]=t[n];for(n in e)r[n]=e[n];return r}(t[e],{once:!0}):t.push({once:!0}),this.on.apply(this,t)},t.prototype.off=function(t,e){var n,r,o,i;if(1===arguments.length&&"function"==typeof t){for(o in e=t,this._handlers)this._handlers[o]=s(this._handlers[o],e),0===this._handlers[o].length&&delete this._handlers[o];this._handlersAll=s(this._handlersAll,e),this._handlersComplex=s(this._handlersComplex,e)}else if(1!==arguments.length||"string"!=typeof t&&"symbol"!=typeof t)if(2===arguments.length){var a=[].concat(t);for(n=0,r=a.length;n<r;n++)i=a[n],this._handlers[i]=s(this._handlers[i],e),0===(this._handlers[i]||[]).length&&delete this._handlers[i]}else c(t)&&p(t,this.off,this);else delete this._handlers[t];return this},t.prototype.listeners=function(t){var e,n,r,o=this._handlersAll||[],i=!1;if(!t)throw Error("Emitter.listeners: no event provided.");for(o=o.concat(this._handlers[t]||[]),n=0,r=this._handlersComplex.length;n<r;n++)e=this._handlersComplex[n],~t.search(e.pattern)&&(i=!0,o.push(e));return this._handlersAll.length||i?o.sort(function(t,e){return t.order-e.order}):o.slice(0)},t.prototype.emit=function(t,e){if(!this._enabled)return this;if(c(t))return p(t,this.emit,this),this;var n,r,o,i,a,s,l,u,h=[].concat(t),f=[];for(a=0,l=h.length;a<l;a++){for(s=0,u=(o=this.listeners(h[a])).length;s<u;s++)i=o[s],n={type:h[a],target:this},1<arguments.length&&(n.data=e),i.fn.call("scope"in i?i.scope:this,n),i.once&&f.push(i);for(s=f.length-1;0<=s;s--)(r=f[s].type?this._handlers[f[s].type]:f[s].pattern?this._handlersComplex:this._handlersAll).splice(r.indexOf(f[s]),1)}return this},t.prototype.kill=function(){this.unbindAll(),this._handlers=null,this._handlersAll=null,this._handlersComplex=null,this._enabled=!1,this.unbindAll=this.on=this.once=this.off=this.emit=this.listeners=Function.prototype},t.prototype.disable=function(){return this._enabled=!1,this},t.prototype.enable=function(){return this._enabled=!0,this},t.version="3.1.1",void 0!==n?(void 0!==e&&e.exports&&(n=e.exports=t),n.Emitter=t):this.Emitter=t}).call(this)},{}],2:[function(t,e,n){"use strict";var r=i(t("emmett")),a=i(t("./cursor")),s=t("./monkey"),l=i(t("./watcher")),y=i(t("./type")),v=i(t("./update")),o=function(t){{if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}}(t("./helpers"));function i(t){return t&&t.__esModule?t:{default:t}}var u=o.arrayFrom,m=o.coercePath,h=o.deepFreeze,b=o.getIn,g=o.makeError,_=o.deepClone,w=o.deepMerge,k=o.shallowClone,P=o.shallowMerge,j=o.hashPath,f={autoCommit:!0,asynchronous:!0,immutable:!0,lazyMonkeys:!0,monkeyBusiness:!0,persistent:!0,pure:!0,validate:null,validationBehavior:"rollback"},c=function(o){function i(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,o.call(this));if(arguments.length<1&&(t={}),!y.default.object(t)&&!y.default.array(t))throw g("Baobab: invalid data.",{data:t});n.options=P({},f,e),n.options.persistent||(n.options.immutable=!1,n.options.pure=!1),n._identity="[object Baobab]",n._cursors={},n._future=null,n._transaction=[],n._affectedPathsIndex={},n._monkeys={},n._previousData=null,n._data=t,n.root=new a.default(n,[],"λ"),delete n.root.release,n.options.immutable&&h(n._data);["apply","clone","concat","deepClone","deepMerge","exists","get","push","merge","pop","project","serialize","set","shift","splice","unset","unshift"].forEach(function(e){n[e]=function(){var t=this.root[e].apply(this.root,arguments);return t instanceof a.default?this:t}}),n.options.monkeyBusiness&&n._refreshMonkeys();var r=n.validate();if(r)throw Error("Baobab: invalid data.",{error:r});return n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(i,o),i.prototype._refreshMonkeys=function(t,e,n){var i=this,r=function t(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(e instanceof s.MonkeyDefinition||e instanceof s.Monkey){var r=new s.Monkey(i,n,e instanceof s.Monkey?e.definition:e);(0,v.default)(i._monkeys,n,{type:"set",value:r},{immutable:!1,persistent:!1,pure:!1})}else if(y.default.object(e))for(var o in e)t(e[o],n.concat(o))};if(arguments.length){var o=b(this._monkeys,e).data;o&&function t(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(e instanceof s.Monkey)return e.release(),void(0,v.default)(i._monkeys,n,{type:"unset"},{immutable:!1,persistent:!1,pure:!1});if(y.default.object(e))for(var r in e)t(e[r],n.concat(r))}(o,e),"unset"!==n&&r(t,e)}else r(this._data);return this},i.prototype.validate=function(t){var e=this.options,n=e.validate,r=e.validationBehavior;if("function"!=typeof n)return null;var o=n.call(this,this._previousData,this._data,t||[[]]);return o instanceof Error?("rollback"===r&&(this._data=this._previousData,this._affectedPathsIndex={},this._transaction=[],this._previousData=this._data),this.emit("invalid",{error:o}),o):null},i.prototype.select=function(t){if(t=t||[],1<arguments.length&&(t=u(arguments)),!y.default.path(t))throw g("Baobab.select: invalid path.",{path:t});t=[].concat(t);var e=j(t),n=this._cursors[e];return n||(n=new a.default(this,t,e),this._cursors[e]=n),this.emit("select",{path:t,cursor:n}),n},i.prototype.update=function(t,e){var n=this;if(t=m(t),!y.default.operationType(e.type))throw g('Baobab.update: unknown operation type "'+e.type+'".',{operation:e});var r=b(this._data,t),o=r.solvedPath,i=r.exists;if(!o)throw g("Baobab.update: could not solve the given path.",{path:o});var a=y.default.monkeyPath(this._monkeys,o);if(a&&o.length>a.length)throw g("Baobab.update: attempting to update a read-only path.",{path:o});if("unset"!==e.type||i){var s=e;if(/merge/i.test(e.type)){var l=b(this._monkeys,o).data;if(y.default.object(l)){s=k(s);var u=b(this._data,o).data;/deep/i.test(s.type)?s.value=w({},w({},u,_(l)),s.value):s.value=P({},w({},u,_(l)),s.value)}}this._transaction.length||(this._previousData=this._data);var h=(0,v.default)(this._data,o,s,this.options),f=h.data,c=h.node;if(!("data"in h))return c;var p=o.concat("push"===e.type?c.length-1:[]),d=j(p);return this._data=f,this._affectedPathsIndex[d]=!0,this._transaction.push(P({},e,{path:p})),this.options.monkeyBusiness&&this._refreshMonkeys(c,o,e.type),this.emit("write",{path:p}),this.options.autoCommit?(this.options.asynchronous?this._future||(this._future=setTimeout(function(){return n.commit()},0)):this.commit(),c):c}},i.prototype.commit=function(){if(!this._transaction.length)return this;this._future&&(this._future=clearTimeout(this._future));var t=Object.keys(this._affectedPathsIndex).map(function(t){return"λ"!==t?t.split("λ").slice(1):[]});if(this.validate(t))return this;var e=this._transaction,n=this._previousData;return this._affectedPathsIndex={},this._transaction=[],this._previousData=this._data,this.emit("update",{paths:t,currentData:this._data,transaction:e,previousData:n}),this},i.prototype.getMonkey=function(t){t=m(t);var e=b(this._monkeys,[].concat(t)).data;return e instanceof s.Monkey?e:null},i.prototype.watch=function(t){return new l.default(this,t)},i.prototype.release=function(){var t=void 0;for(t in this.emit("release"),delete this.root,delete this._data,delete this._previousData,delete this._transaction,delete this._affectedPathsIndex,delete this._monkeys,this._cursors)this._cursors[t].release();delete this._cursors,this.kill()},i.prototype.toJSON=function(){return this.serialize()},i.prototype.toString=function(){return this._identity},i}(r.default);c.monkey=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(!e.length)throw new Error("Baobab.monkey: missing definition.");return 1===e.length&&"function"!=typeof e[0]?new s.MonkeyDefinition(e[0]):new s.MonkeyDefinition(e)},c.dynamicNode=c.monkey,c.Cursor=a.default,c.MonkeyDefinition=s.MonkeyDefinition,c.Monkey=s.Monkey,c.type=y.default,c.helpers=o,c.VERSION="2.5.2",e.exports=c},{"./cursor":3,"./helpers":4,"./monkey":5,"./type":6,"./update":7,"./watcher":8,emmett:1}],3:[function(t,e,n){"use strict";n.__esModule=!0;var r=o(t("emmett")),a=t("./monkey"),s=o(t("./type")),l=t("./helpers");function o(t){return t&&t.__esModule?t:{default:t}}function u(t,e){if(!e)throw(0,l.makeError)("Baobab.Cursor."+t+": cannot use "+t+" on an unresolved dynamic path.",{path:e})}var i=function(o){function i(t,e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var a=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,o.call(this));e=e||[],a._identity="[object Cursor]",a._archive=null,a.tree=t,a.path=e,a.hash=n,a.state={killed:!1,recording:!1,undoing:!1},a._dynamicPath=s.default.dynamicPath(a.path),a._monkeyPath=s.default.monkeyPath(a.tree._monkeys,a.path),a._dynamicPath?a.solvedPath=(0,l.getIn)(a.tree._data,a.path).solvedPath:a.solvedPath=a.path,a._writeHandler=function(t){var e=t.data;!a.state.killed&&(0,l.solveUpdate)([e.path],a._getComparedPaths())&&(a.solvedPath=(0,l.getIn)(a.tree._data,a.path).solvedPath)};a._updateHandler=function(t){if(!a.state.killed){var e=t.data,n=e.paths,r=e.previousData,o=function(t){var e=a,n={get previousData(){return(0,l.getIn)(t,e.solvedPath).data},get currentData(){return e.get()}};return a.state.recording&&!a.state.undoing&&a.archive.add(n.previousData),a.state.undoing=!1,a.emit("update",n)}.bind(a,r),i=a._getComparedPaths();return(0,l.solveUpdate)(n,i)?o():void 0}};var r=!1;return a._lazyBind=function(){if(!r)return r=!0,a._dynamicPath&&a.tree.on("write",a._writeHandler),a.tree.on("update",a._updateHandler)},a._dynamicPath?a._lazyBind():(a.on=(0,l.before)(a._lazyBind,a.on.bind(a)),a.once=(0,l.before)(a._lazyBind,a.once.bind(a))),a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(i,o),i.prototype._getComparedPaths=function(){var t=this._monkeyPath?(0,l.getIn)(this.tree._monkeys,this._monkeyPath).data.relatedPaths():[];return[this.solvedPath].concat(t)},i.prototype.isRoot=function(){return!this.path.length},i.prototype.isLeaf=function(){return s.default.primitive(this._get().data)},i.prototype.isBranch=function(){return!this.isRoot()&&!this.isLeaf()},i.prototype.root=function(){return this.tree.select()},i.prototype.select=function(t){return 1<arguments.length&&(t=(0,l.arrayFrom)(arguments)),this.tree.select(this.path.concat(t))},i.prototype.up=function(){return this.isRoot()?null:this.tree.select(this.path.slice(0,-1))},i.prototype.down=function(){if(u("down",this.solvedPath),!(this._get().data instanceof Array))throw Error("Baobab.Cursor.down: cannot go down on a non-list type.");return this.tree.select(this.solvedPath.concat(0))},i.prototype.left=function(){u("left",this.solvedPath);var t=+this.solvedPath[this.solvedPath.length-1];if(isNaN(t))throw Error("Baobab.Cursor.left: cannot go left on a non-list type.");return t?this.tree.select(this.solvedPath.slice(0,-1).concat(t-1)):null},i.prototype.right=function(){u("right",this.solvedPath);var t=+this.solvedPath[this.solvedPath.length-1];if(isNaN(t))throw Error("Baobab.Cursor.right: cannot go right on a non-list type.");return t+1===this.up()._get().data.length?null:this.tree.select(this.solvedPath.slice(0,-1).concat(t+1))},i.prototype.leftmost=function(){u("leftmost",this.solvedPath);var t=+this.solvedPath[this.solvedPath.length-1];if(isNaN(t))throw Error("Baobab.Cursor.leftmost: cannot go left on a non-list type.");return this.tree.select(this.solvedPath.slice(0,-1).concat(0))},i.prototype.rightmost=function(){u("rightmost",this.solvedPath);var t=+this.solvedPath[this.solvedPath.length-1];if(isNaN(t))throw Error("Baobab.Cursor.rightmost: cannot go right on a non-list type.");var e=this.up()._get().data;return this.tree.select(this.solvedPath.slice(0,-1).concat(e.length-1))},i.prototype.map=function(n,r){u("map",this.solvedPath);var o=this._get().data,i=arguments.length;if(!s.default.array(o))throw Error("baobab.Cursor.map: cannot map a non-list type.");return o.map(function(t,e){return n.call(1<i?r:this,this.select(e),e,o)},this)},i.prototype._get=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];if(!s.default.path(t))throw(0,l.makeError)("Baobab.Cursor.getters: invalid path.",{path:t});return this.solvedPath?(0,l.getIn)(this.tree._data,this.solvedPath.concat(t)):{data:void 0,solvedPath:null,exists:!1}},i.prototype.exists=function(t){return t=(0,l.coercePath)(t),1<arguments.length&&(t=(0,l.arrayFrom)(arguments)),this._get(t).exists},i.prototype.get=function(t){t=(0,l.coercePath)(t),1<arguments.length&&(t=(0,l.arrayFrom)(arguments));var e=this._get(t),n=e.data,r=e.solvedPath;return this.tree.emit("get",{data:n,solvedPath:r,path:this.path.concat(t)}),n},i.prototype.clone=function(){var t=this.get.apply(this,arguments);return(0,l.shallowClone)(t)},i.prototype.deepClone=function(){var t=this.get.apply(this,arguments);return(0,l.deepClone)(t)},i.prototype.serialize=function(t){if(t=(0,l.coercePath)(t),1<arguments.length&&(t=(0,l.arrayFrom)(arguments)),!s.default.path(t))throw(0,l.makeError)("Baobab.Cursor.getters: invalid path.",{path:t});if(this.solvedPath){var e=this.solvedPath.concat(t),n=(0,l.deepClone)((0,l.getIn)(this.tree._data,e).data);return function t(e,n){if(s.default.object(n)&&s.default.object(e))for(var r in n)n[r]instanceof a.Monkey?delete e[r]:t(e[r],n[r])}(n,(0,l.getIn)(this.tree._monkeys,e).data),n}},i.prototype.project=function(t){if(s.default.object(t)){var e={};for(var n in t)e[n]=this.get(t[n]);return e}if(s.default.array(t)){for(var r=[],o=0,i=t.length;o<i;o++)r.push(this.get(t[o]));return r}throw(0,l.makeError)("Baobab.Cursor.project: wrong projection.",{projection:t})},i.prototype.startRecording=function(t){if((t=t||1/0)<1)throw(0,l.makeError)("Baobab.Cursor.startRecording: invalid max records.",{value:t});return this.state.recording=!0,this.archive||(this._lazyBind(),this.archive=new l.Archive(t)),this},i.prototype.stopRecording=function(){return this.state.recording=!1,this},i.prototype.undo=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;if(!this.state.recording)throw new Error("Baobab.Cursor.undo: cursor is not recording.");var e=this.archive.back(t);if(!e)throw Error("Baobab.Cursor.undo: cannot find a relevant record.");return this.state.undoing=!0,this.set(e),this},i.prototype.hasHistory=function(){return!(!this.archive||!this.archive.get().length)},i.prototype.getHistory=function(){return this.archive?this.archive.get():[]},i.prototype.clearHistory=function(){return this.archive&&this.archive.clear(),this},i.prototype.release=function(){this._dynamicPath&&this.tree.off("write",this._writeHandler),this.tree.off("update",this._updateHandler),this.hash&&delete this.tree._cursors[this.hash],delete this.tree,delete this.path,delete this.solvedPath,delete this.archive,this.kill(),this.state.killed=!0},i.prototype.toJSON=function(){return this.serialize()},i.prototype.toString=function(){return this._identity},i}(r.default);n.default=i,"function"==typeof Symbol&&void 0!==Symbol.iterator&&(i.prototype[Symbol.iterator]=function(){var t=this._get().data;if(!s.default.array(t))throw Error("baobab.Cursor.@@iterate: cannot iterate a non-list type.");var e=0,n=this,r=t.length;return{next:function(){return e<r?{value:n.select(e++)}:{done:!0}}}});var h={unset:!0,pop:!0,shift:!0};function f(r,o){i.prototype[r]=function(t,e){if(2<arguments.length)throw(0,l.makeError)("Baobab.Cursor."+r+": too many arguments.");if(1!==arguments.length||h[r]||(e=t,t=[]),t=(0,l.coercePath)(t),!s.default.path(t))throw(0,l.makeError)("Baobab.Cursor."+r+": invalid path.",{path:t});if(o&&!o(e))throw(0,l.makeError)("Baobab.Cursor."+r+": invalid value.",{path:t,value:e});if(!this.solvedPath)throw(0,l.makeError)("Baobab.Cursor."+r+": the dynamic path of the cursor cannot be solved.",{path:this.path});var n=this.solvedPath.concat(t);return this.tree.update(n,{type:r,value:e})}}f("set"),f("unset"),f("apply",s.default.function),f("push"),f("concat",s.default.array),f("unshift"),f("pop"),f("shift"),f("splice",s.default.splicer),f("merge",s.default.object),f("deepMerge",s.default.object)},{"./helpers":4,"./monkey":5,"./type":6,emmett:1}],4:[function(k,t,P){(function(d){"use strict";P.__esModule=!0,P.uniqid=P.deepMerge=P.shallowMerge=P.deepFreeze=P.freeze=P.deepClone=P.shallowClone=P.Archive=void 0;var y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};P.arrayFrom=function(t){return b(t)},P.before=function(t,e){return function(){t.apply(null,arguments),e.apply(null,arguments)}},P.coercePath=function(t){return t||0===t||""===t?t:[]},P.getIn=function(t,e){if(!e)return h;var n=[],r=!0,o=t,i=void 0,a=void 0,s=void 0;for(a=0,s=e.length;a<s;a++){if(!o)return{data:void 0,solvedPath:n.concat(e.slice(a)),exists:!1};if("function"==typeof e[a]){if(!m.default.array(o))return h;if(!~(i=l(o,e[a])))return h;n.push(i),o=o[i]}else if("object"===y(e[a])){if(!m.default.array(o))return h;if(!~(i=l(o,function(t){return u(t,e[a])})))return h;n.push(i),o=o[i]}else n.push(e[a]),r="object"===(void 0===o?"undefined":y(o))&&e[a]in o,o=o[e[a]]}return{data:o,solvedPath:n,exists:r}},P.makeError=function(t,e){var n=new Error(t);for(var r in e)n[r]=e[r];return n},P.hashPath=function(t){return"λ"+t.map(function(t){return m.default.function(t)||m.default.object(t)?"#"+w()+"#":t}).join("λ")},P.solveRelativePath=function(t,e){var n=[];e=[].concat(e);for(var r=0,o=e.length;r<o;r++){var i=e[r];"."===i?r||(n=t.slice(0)):".."===i?n=(r?n:t).slice(0,-1):n.push(i)}return n},P.solveUpdate=function(t,e){var n=void 0,r=void 0,o=void 0,i=void 0,a=void 0,s=void 0,l=void 0,u=void 0;for(n=0,i=t.length;n<i;n++){if(!(l=t[n]).length)return!0;for(r=0,a=e.length;r<a;r++){if(!(u=e[r])||!u.length)return!0;for(o=0,s=u.length;o<s&&u[o]==l[o];o++)if(o+1===s||o+1===l.length)return!0}}return!1},P.splice=function(t,e,n){for(var r=arguments.length,o=Array(3<r?r-3:0),i=3;i<r;i++)o[i-3]=arguments[i];if(void 0===n&&2===arguments.length)n=t.length-e;else if(null==n)n=0;else if(isNaN(+n))throw new Error("argument nb "+n+" can not be parsed into a number!");n=Math.max(0,n),m.default.function(e)&&(e=l(t,e));m.default.object(e)&&(e=l(t,function(t){return u(t,e)}));return 0<=e?t.slice(0,e).concat(o).concat(t.slice(e+n)):t.slice(0,t.length+e).concat(o).concat(t.slice(t.length+e+n))};var t,v=k("./monkey"),e=k("./type"),m=(t=e)&&t.__esModule?t:{default:t};var a={}.hasOwnProperty;function l(t,e){var n,r=void 0;for(r=0,n=t.length;r<n;r++)if(e(t[r]))return r;return-1}function b(t){var e,n=new Array(t.length),r=void 0;for(r=0,e=t.length;r<e;r++)n[r]=t[r];return n}P.Archive=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.size=t,this.records=[]}return e.prototype.get=function(){return this.records},e.prototype.add=function(t){return this.records.unshift(t),this.records.length>this.size&&(this.records.length=this.size),this},e.prototype.clear=function(){return this.records=[],this},e.prototype.back=function(t){var e=this.records[t-1];return e&&(this.records=this.records.slice(t)),e},e}();function g(t,e){if(!e||"object"!==(void 0===e?"undefined":y(e))||e instanceof Error||e instanceof v.MonkeyDefinition||e instanceof v.Monkey||"ArrayBuffer"in d&&e instanceof ArrayBuffer)return e;if(m.default.array(e)){if(t){for(var n=new Array(e.length),r=0,o=e.length;r<o;r++)n[r]=g(!0,e[r]);return n}return b(e)}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return a=(i=e).source,s="",i.global&&(s+="g"),i.multiline&&(s+="m"),i.ignoreCase&&(s+="i"),i.sticky&&(s+="y"),i.unicode&&(s+="u"),new RegExp(a,s);var i,a,s;if(m.default.object(e)){for(var l={},u=Object.getOwnPropertyNames(e),h=0,f=u.length;h<f;h++){var c=u[h],p=Object.getOwnPropertyDescriptor(e,c);!0===p.enumerable?p.get&&p.get.isLazyGetter?Object.defineProperty(l,c,{get:p.get,enumerable:!0,configurable:!0}):l[c]=t?g(!0,e[c]):e[c]:!1===p.enumerable&&Object.defineProperty(l,c,{value:t?g(!0,p.value):p.value,enumerable:!1,writable:!0,configurable:!0})}return l}return e}var n=g.bind(null,!1),r=g.bind(null,!0);function u(t,e){var n=!0,r=void 0;if(!t)return!1;for(r in e)if(m.default.object(e[r]))n=n&&u(t[r],e[r]);else if(m.default.array(e[r]))n=n&&!!~e[r].indexOf(t[r]);else if(t[r]!==e[r])return!1;return n}function o(t,e){if(!("object"!==(void 0===e?"undefined":y(e))||null===e||e instanceof v.Monkey)&&(Object.freeze(e),t))if(Array.isArray(e)){var n,r=void 0;for(r=0,n=e.length;r<n;r++)s(e[r])}else{var o=void 0,i=void 0;for(i in e)m.default.lazyGetter(e,i)||(o=e[i])&&a.call(e,i)&&"object"===(void 0===o?"undefined":y(o))&&!Object.isFrozen(o)&&s(o)}}P.shallowClone=n,P.deepClone=r;var i=o.bind(null,!1),s=o.bind(null,!0);P.freeze=i,P.deepFreeze=s;var h={data:void 0,solvedPath:null,exists:!1};function f(t){for(var e=arguments.length,n=Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var o,i=n[0],a=void 0,s=void 0,l=void 0;for(s=1,o=n.length;s<o;s++)for(l in a=n[s])!t||!m.default.object(a[l])||a[l]instanceof v.Monkey?i[l]=a[l]:i[l]=f(!0,i[l]||{},a[l]);return i}var c=f.bind(null,!1),p=f.bind(null,!0);P.shallowMerge=c,P.deepMerge=p;var _,w=(_=0,function(){return _++});P.uniqid=w}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./monkey":5,"./type":6}],5:[function(t,e,n){"use strict";n.__esModule=!0,n.Monkey=n.MonkeyDefinition=void 0;var s=r(t("./type")),u=r(t("./update")),h=t("./helpers");function r(t){return t&&t.__esModule?t:{default:t}}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.MonkeyDefinition=function t(e){var n=this;l(this,t);var r=s.default.monkeyDefinition(e);if(!r)throw(0,h.makeError)("Baobab.monkey: invalid definition.",{definition:e});if(this.type=r,"object"===this.type)this.getter=e.get,this.projection=e.cursors||{},this.paths=Object.keys(this.projection).map(function(t){return n.projection[t]}),this.options=e.options||{};else{var o=1,i={};s.default.object(e[e.length-1])&&(o++,i=e[e.length-1]),this.getter=e[e.length-o],this.projection=e.slice(0,-o),this.paths=this.projection,this.options=i}this.paths=this.paths.map(function(t){return[].concat(t)}),this.hasDynamicPaths=this.paths.some(s.default.dynamicPath)},n.Monkey=function(){function a(t,e,n){var o=this;l(this,a),this.tree=t,this.path=e;var r=(this.definition=n).projection,i=h.solveRelativePath.bind(null,e.slice(0,-1));"object"===n.type?(this.projection=Object.keys(r).reduce(function(t,e){return t[e]=i(r[e]),t},{}),this.depPaths=Object.keys(this.projection).map(function(t){return o.projection[t]})):(this.projection=r.map(i),this.depPaths=this.projection),this.state={killed:!1},this.writeListener=function(t){var e=t.data.path;o.state.killed||(0,h.solveUpdate)([e],o.relatedPaths())&&o.update()},this.recursiveListener=function(t){var e=t.data,n=e.monkey,r=e.path;o.state.killed||o!==n&&(0,h.solveUpdate)([r],o.relatedPaths(!1))&&o.update()},this.tree.on("write",this.writeListener),this.tree.on("_monkey",this.recursiveListener),this.update()}return a.prototype.relatedPaths=function(){var o=this,t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],e=void 0;return e=this.definition.hasDynamicPaths?this.depPaths.map(function(t){return(0,h.getIn)(o.tree._data,t).solvedPath}):this.depPaths,t&&this.depPaths.some(function(t){return!!s.default.monkeyPath(o.tree._monkeys,t)})?e.reduce(function(t,e){var n=s.default.monkeyPath(o.tree._monkeys,e);if(!n)return t.concat([e]);var r=(0,h.getIn)(o.tree._monkeys,n).data;return t.concat(r.relatedPaths())},[]):e},a.prototype.update=function(){var e,n,r,o,i,a=this,t=this.tree.project(this.projection),s=(e=this.tree,n=this.definition,r=t,o=null,i=!1,function(){if(!i){o=n.getter.apply(e,"object"===n.type?[r]:r),e.options.immutable&&!1!==n.options.immutable&&(0,h.deepFreeze)(o);var t=(0,h.hashPath)(a.path);e._affectedPathsIndex[t]=!0,i=!0}return o});if(s.isLazyGetter=!0,this.tree.options.lazyMonkeys)this.tree._data=(0,u.default)(this.tree._data,this.path,{type:"monkey",value:s},this.tree.options).data;else{var l=(0,u.default)(this.tree._data,this.path,{type:"set",value:s(),options:{mutableLeaf:!this.definition.options.immutable}},this.tree.options);"data"in l&&(this.tree._data=l.data)}return this.tree.emit("_monkey",{monkey:this,path:this.path}),this},a.prototype.release=function(){this.tree.off("write",this.writeListener),this.tree.off("_monkey",this.recursiveListener),this.state.killed=!0,delete this.projection,delete this.depPaths,delete this.tree},a}()},{"./helpers":4,"./type":6,"./update":7}],6:[function(t,e,n){"use strict";n.__esModule=!0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=t("./monkey"),r={};function o(e,t){return t.some(function(t){return r[t](e)})}r.array=function(t){return Array.isArray(t)},r.object=function(t){return t&&"object"===(void 0===t?"undefined":a(t))&&!Array.isArray(t)&&!(t instanceof Date)&&!(t instanceof RegExp)&&!("function"==typeof Map&&t instanceof Map)&&!("function"==typeof Set&&t instanceof Set)},r.string=function(t){return"string"==typeof t},r.number=function(t){return"number"==typeof t},r.function=function(t){return"function"==typeof t},r.primitive=function(t){return t!==Object(t)},r.splicer=function(t){return!(!r.array(t)||t.length<1)&&(!(1<t.length&&isNaN(+t[1]))&&o(t[0],["number","function","object"]))};var i=["string","number","function","object"];r.path=function(t){return!(!t&&0!==t&&""!==t)&&[].concat(t).every(function(t){return o(t,i)})},r.dynamicPath=function(t){return t.some(function(t){return r.function(t)||r.object(t)})},r.monkeyPath=function(t,e){var n,r=[],o=t,i=void 0;for(i=0,n=e.length;i<n;i++){if(r.push(e[i]),"object"!==(void 0===o?"undefined":a(o)))return null;if((o=o[e[i]])instanceof s.Monkey)return r}return null},r.lazyGetter=function(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return n&&n.get&&!0===n.get.isLazyGetter},r.monkeyDefinition=function(e){if(r.object(e))return r.function(e.get)&&(!e.cursors||r.object(e.cursors)&&Object.keys(e.cursors).every(function(t){return r.path(e.cursors[t])}))?"object":null;if(r.array(e)){var t=1;return r.object(e[e.length-1])&&t++,r.function(e[e.length-t])&&e.slice(0,-t).every(function(t){return r.path(t)})?"array":null}return null},r.watcherMapping=function(e){return r.object(e)&&Object.keys(e).every(function(t){return r.path(e[t])})};var l=["set","apply","push","unshift","concat","pop","shift","deepMerge","merge","splice","unset"];r.operationType=function(t){return"string"==typeof t&&!!~l.indexOf(t)},n.default=r},{"./monkey":5}],7:[function(t,e,n){"use strict";n.__esModule=!0,n.default=function(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},o=n.type,i=n.value,a=n.options,s=void 0===a?{}:a,l={root:t},u=["root"].concat(e),h=[],f=l,c=void 0,p=void 0,d=void 0;for(c=0,p=u.length;c<p;c++){if(d=u[c],0<c&&h.push(d),c===p-1){if("set"===o){if(r.pure&&f[d]===i)return{node:f[d]};v.default.lazyGetter(f,d)?Object.defineProperty(f,d,{value:i,enumerable:!0,configurable:!0}):r.persistent&&!s.mutableLeaf?f[d]=(0,m.shallowClone)(i):f[d]=i}else if("monkey"===o)Object.defineProperty(f,d,{get:i,enumerable:!0,configurable:!0});else if("apply"===o){var y=i(f[d]);if(r.pure&&f[d]===y)return{node:f[d]};v.default.lazyGetter(f,d)?Object.defineProperty(f,d,{value:y,enumerable:!0,configurable:!0}):r.persistent?f[d]=(0,m.shallowClone)(y):f[d]=y}else if("push"===o){if(!v.default.array(f[d]))throw b("push","array",h);r.persistent?f[d]=f[d].concat([i]):f[d].push(i)}else if("unshift"===o){if(!v.default.array(f[d]))throw b("unshift","array",h);r.persistent?f[d]=[i].concat(f[d]):f[d].unshift(i)}else if("concat"===o){if(!v.default.array(f[d]))throw b("concat","array",h);r.persistent?f[d]=f[d].concat(i):f[d].push.apply(f[d],i)}else if("splice"===o){if(!v.default.array(f[d]))throw b("splice","array",h);r.persistent?f[d]=m.splice.apply(null,[f[d]].concat(i)):f[d].splice.apply(f[d],i)}else if("pop"===o){if(!v.default.array(f[d]))throw b("pop","array",h);r.persistent?f[d]=(0,m.splice)(f[d],-1,1):f[d].pop()}else if("shift"===o){if(!v.default.array(f[d]))throw b("shift","array",h);r.persistent?f[d]=(0,m.splice)(f[d],0,1):f[d].shift()}else if("unset"===o)v.default.object(f)?delete f[d]:v.default.array(f)&&f.splice(d,1);else if("merge"===o){if(!v.default.object(f[d]))throw b("merge","object",h);r.persistent?f[d]=(0,m.shallowMerge)({},f[d],i):f[d]=(0,m.shallowMerge)(f[d],i)}else if("deepMerge"===o){if(!v.default.object(f[d]))throw b("deepMerge","object",h);r.persistent?f[d]=(0,m.deepMerge)({},f[d],i):f[d]=(0,m.deepMerge)(f[d],i)}r.immutable&&!s.mutableLeaf&&(0,m.deepFreeze)(f);break}v.default.primitive(f[d])?f[d]={}:r.persistent&&(f[d]=(0,m.shallowClone)(f[d])),r.immutable&&0<p&&(0,m.freeze)(f),f=f[d]}return v.default.lazyGetter(f,d)?{data:l.root}:{data:l.root,node:f[d]}};var r,o=t("./type"),v=(r=o)&&r.__esModule?r:{default:r},m=t("./helpers");function b(t,e,n){return(0,m.makeError)('Baobab.update: cannot apply the "'+t+'" on a non '+e+" (path: /"+n.join("/")+").",{path:n})}},{"./helpers":4,"./type":6}],8:[function(t,e,n){"use strict";n.__esModule=!0;var r=o(t("emmett")),i=o(t("./cursor")),a=o(t("./type")),s=t("./helpers");function o(t){return t&&t.__esModule?t:{default:t}}var l=function(r){function o(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,r.call(this));return n.tree=t,n.mapping=null,n.state={killed:!1},n.refresh(e),n.handler=function(t){if(!n.state.killed){var e=n.getWatchedPaths();return(0,s.solveUpdate)(t.data.paths,e)?n.emit("update"):void 0}},n.tree.on("update",n.handler),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(o,r),o.prototype.getWatchedPaths=function(){var r=this;return Object.keys(this.mapping).map(function(t){var e=r.mapping[t];return e instanceof i.default?e.solvedPath:r.mapping[t]}).reduce(function(t,e){if(e=[].concat(e),a.default.dynamicPath(e)&&(e=(0,s.getIn)(r.tree._data,e).solvedPath),!e)return t;var n=a.default.monkeyPath(r.tree._monkeys,e);return n?t.concat((0,s.getIn)(r.tree._monkeys,n).data.relatedPaths()):t.concat([e])},[])},o.prototype.getCursors=function(){var n=this,r={};return Object.keys(this.mapping).forEach(function(t){var e=n.mapping[t];e instanceof i.default?r[t]=e:r[t]=n.tree.select(e)}),r},o.prototype.refresh=function(t){if(!a.default.watcherMapping(t))throw(0,s.makeError)("Baobab.watch: invalid mapping.",{mapping:t});this.mapping=t;var e={};for(var n in t)e[n]=t[n]instanceof i.default?t[n].path:t[n];this.get=this.tree.project.bind(this.tree,e)},o.prototype.release=function(){this.tree.off("update",this.handler),this.state.killed=!0,this.kill()},o}(r.default);n.default=l},{"./cursor":3,"./helpers":4,"./type":6,emmett:1}]},{},[2])(2)});